webpackJsonp([5],{"+Y0J":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("lktp"),i=a("9bIa"),o=a("G/3p"),l={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"entity_left"},[n("happy-scroll",[n("div",{staticClass:"entity_left_item"},[n("div",{staticClass:"eli_title"},[n("img",{attrs:{src:a("AOzm")}}),t._v(" "),n("p",[t._v("数据库实体配置")])])]),t._v(" "),n("div",{staticClass:"entity_left_content"},[n("div",{staticClass:"elc_add",on:{click:t.open}},[n("button",{staticClass:"elc_add_btn",attrs:{type:"text"}},[n("i",{staticClass:"iconfont icon-jia fl"}),t._v(" "),n("span",{staticClass:"fl"},[t._v("新建实体")])])]),t._v(" "),n("foreign-key-left-list"),t._v(" "),n("collapse-entity",{attrs:{list:t.list,pageType:"entity"},on:{"event-click-entity":t.getShow,"event-click-change":t.changeName,"event-click-delete":t.deleteName}})],1)])],1)},staticRenderFns:[]};var r=function(t){a("cS2E")},s=a("vSla")(o.a,l,!1,r,"data-v-19495de0",null).exports,c=a("dhLY"),m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"entity_right"},[a("div",{staticClass:"entity_right_title"},[a("span",[t._v(t._s(t.entityDataObj.entityName))]),t._v(" "),a("div",{staticClass:"add_cancel_none"},[a("button",{staticClass:"add_none el-btn save",on:{click:t.add_preservation}},[t._v("保存")]),t._v(" "),a("button",{staticClass:"cance_none el-btn cancel",on:{click:t.cancel_preservation}},[t._v("取消")])])]),t._v(" "),a("div",{staticClass:"entity_right_jsplumb"},[a("entity-js-plumb"),t._v(" "),a("entity-more",{ref:"entityMore"})],1)])},staticRenderFns:[]};var d=function(t){a("+dNF")},u=a("vSla")(c.a,m,!1,d,"data-v-f6bfc47a",null).exports,f={components:{leftBar:n.a,rightContent:i.a,entityLeft:s,entityContent:u},data:function(){return{}},computed:{},watch:{},methods:{},created:function(){},mounted:function(){}},h={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"entity"},[e("left-bar",[e("entity-left")],1),this._v(" "),e("right-content",[e("entity-content")],1)],1)},staticRenderFns:[]};var p=a("vSla")(f,h,!1,function(t){a("PzVd")},"data-v-821184b2",null);e.default=p.exports},"+dNF":function(t,e){},"/gfp":function(t,e,a){"use strict";var n=a("tbaP"),i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"entity_more"},[a("div",{staticClass:"entity_top"},[a("el-form",{ref:"formEntity",staticClass:"clearfix",attrs:{rules:t.rules,"label-position":t.labelPosition,"label-width":"80px",model:t.formEntity,size:"mini"}},[a("el-form-item",{attrs:{label:"实体主键",prop:"majorKeyName"}},[a("el-select",{attrs:{placeholder:"请选择表","popper-append-to-body":!1},on:{change:t.changeMajorKeyName},model:{value:t.formEntity.majorKeyName,callback:function(e){t.$set(t.formEntity,"majorKeyName",e)},expression:"formEntity.majorKeyName"}},t._l(t.opMajorKeyName,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.tableName}})}))],1),t._v(" "),a("el-form-item",{staticClass:"column_id",attrs:{prop:"majorKeyField"}},[a("el-select",{attrs:{placeholder:"请先选择表","popper-append-to-body":!1},on:{change:t.changeMajorKeyField},model:{value:t.formEntity.majorKeyField,callback:function(e){t.$set(t.formEntity,"majorKeyField",e)},expression:"formEntity.majorKeyField"}},t._l(t.opMajorKeyField,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.columnName}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"字面量",prop:"literalName"}},[a("el-select",{attrs:{placeholder:"请选择表","popper-append-to-body":!1},on:{change:t.changeLiteralName},model:{value:t.formEntity.literalName,callback:function(e){t.$set(t.formEntity,"literalName",e)},expression:"formEntity.literalName"}},t._l(t.opLiteralName,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.tableName}})}))],1),t._v(" "),a("el-form-item",{staticClass:"column_id",attrs:{prop:"literalField"}},[a("el-select",{attrs:{placeholder:"请先选择表","popper-append-to-body":!1},on:{change:t.changeLiteralField},model:{value:t.formEntity.literalField,callback:function(e){t.$set(t.formEntity,"literalField",e)},expression:"formEntity.literalField"}},t._l(t.opLiteralField,function(t,e){return a("el-option",{key:e,attrs:{value:t.id,label:t.columnName}})}))],1)],1)],1),t._v(" "),a("div",{staticClass:"entity_buttom"},[a("el-table",{attrs:{data:t.tableData,height:"calc(100vh - 455px)"}},[a("el-table-column",{attrs:{label:"实体属性名",width:"117",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.toggle?a("span",{staticStyle:{"margin-right":"10px"}},[t._v(t._s(e.row.attrName))]):t._e(),t._v(" "),e.row.toggle?t._e():a("el-input",{ref:"newDate",attrs:{size:"mini"},on:{blur:function(a){t.changeFolder(a,e.row.attrName)}},nativeOn:{keyup:function(a){if(!("button"in a)&&t._k(a.keyCode,"enter",13,a.key,"Enter"))return null;t.changeFolder(a,e.row.attrName)}},model:{value:t.newDate,callback:function(e){t.newDate=e},expression:"newDate"}}),t._v(" "),e.row.toggle?a("i",{staticClass:"iconfont icon-bi",staticStyle:{cursor:"pointer"},on:{click:function(a){t.show(e.$index,e.row.attrName)}}}):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"表名",width:"117",align:"center",prop:"tableName"}}),t._v(" "),a("el-table-column",{attrs:{label:"列名",align:"center",prop:"columnName"}})],1)],1)])},staticRenderFns:[]};var o=function(t){a("Q1ws")},l=a("vSla")(n.a,i,!1,o,"data-v-3f9be16e",null);e.a=l.exports},AOzm:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAeCAYAAAA/xX6fAAADCElEQVRIibXWW4hWVRQH8N/55lZBRReIHrLSMkyjh65CVnQhSgqmhyYitKcgKmgQMsqupHkpH8LooQx6CYwCM40o68GRCkTICF+yi12kyegiEspkq4e9D7M7jt9836R/OJy111pn//deZ+21VxURusQAHsUcLMe2rr6OiG6eBRGxIyL2FM/LEXFBp3NUHe5wEA9gVhuftViFfe0mmozwEgzjuk5WhT/wPF7rlnAaHsKdHRI18S1W4+3JCE+TdnQPWlMkK7ENL2BLSVjhVNyOxTjhKBA1sTkT76wiok/64TccA6ImhloYwwI8gd+PEdFGzMVIC+ukLHwVs/HiUSQawXzcix+xpIqIPdn4LpZgL07CM7hjikS78Rw25PFCPI3+KiK+wOmF81o8nuWZmfjqDoma5/A2LML5ebyviogvpSwtcRBrpMyCa43Xz4kQeAVP5fFleBYXNfz2H4mwxqgUivV5fBcewymFz0YslcJ4LlbgqiPMNylhjc+l0H6Wx0/m1a/GJ4XfxTgR2zFdSsCy/nZMWOMjace72vj04Iq8kOnYinekfJjVbfm6XipTg218FuMt3I9vpIJyX/523VTr5YX5XWEIL6E/6y7P75vye6eUfPMx3DtFwj8LwmHpdrkSf+OsbLtUOvg9OAfzsOn/3gj/SKEbw5kFWY0ZmWxMCqtWXmW3GCjk7Q3bUinMywpd1H69/numOsWvUnW6EbegL+sfNH7pjuAvqQD043W8V0XEQjyCk7sgvFUq9MsL3SGHh/R4fF0qWpl5rlSaOsXZ0m3+Pn4p5prZ8CtL4SjWN9u48yJiTaMNnOhZVHwzIyK+z/qtETE7IloRMSciPs363RExLSIO61t2Se3gzfi4zQ4PFvJeKVtJleVDKUE+yJGQ7b/VYZgIO3C31Al81Ya4B28YP/Q1zmiMB/Ameic7h5txjdR+jBb6Q4X8nZS1Q1Ij9lPW/yBVl0H8LN34XbX5x0XEw/mfrGrYBgp5ZfZZUej6armb0nYAK6VboK9hK//phmzfVOjGauFfjZLHUD0eVv8AAAAASUVORK5CYII="},CceU:function(t,e){},"G/3p":function(t,e,a){"use strict";(function(t){var n=a("4YfN"),i=a.n(n),o=a("9rMa"),l=a("jt1B"),r=a("xS3o"),s=a("wFeW"),c=a("gyMJ");e.a={components:{foreignKeyLeftList:r.a,collapseEntity:s.a},data:function(){return{activeNames:["1"],list:[]}},computed:i()({},Object(o.c)(["foreignKeyList","entityId","entityUpdata","hotWordEntityActive"])),watch:{entityUpdata:{handler:function(t,e){this.getDataEntityAjax()}}},methods:{open:function(){var t=this;this.$prompt("","新增实体",{confirmButtonText:"确定",showCancelButton:!1,confirmButtonClass:"confirm_add",customClass:"add_Box",inputType:"textarea",inputPlaceholder:"请输入您要新增的术语",inputValidator:this.validator,inputErrorMessage:"输入框不能为空"}).then(function(e){var a=e.value,n={};n.entityName=a,n.includeTable=[],t.list.unshift(n),t.getShow({item:n,index:0}),Object(l.a)({message:"添加成功",type:"success"})}).catch(function(t){})},getShow:function(t){console.log("获取到的实体",t);var e=t.item,a=t.index,n=e.entityId?e.entityId:"";if(this.$store.commit("changeEntityId",n),this.$store.commit("changeHotWordEntityActive",a),e.entityId)for(var i=e.includeTable,o=this.foreignKeyList,l=[],r=[],s=0;s<i.length;s++)for(var c=0;c<o.length;c++)for(var m=o[c].database,d=0;d<m.length;d++)for(var u=m[d].table,f=0;f<u.length;f++)i[s].tableId==u[f].id&&(l.push(u[f]),r.push(u[f]),this.$store.commit("changeEntityDataObj",e),this.$store.commit("changeEntityLeftList",l),this.$store.commit("changeEntityListName",r));else this.$store.commit("changeEntityDataObj",e),this.$store.commit("changeEntityLeftList",[]),this.$store.commit("changeEntityListName",[])},validator:function(t){return""!=t.trim()&&null!=t},changeName:function(t){var e=this,a=t.entityName,n=t.index;this.$prompt("请输入名字","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputValue:a,customClass:"change_Box",inputValidator:this.validator,inputErrorMessage:"输入框不能为空"}).then(function(t){var a=t.value;e.list[n].entityName=a}).catch(function(t){})},deleteName:function(e){var a=this,n=e.entityId,i=e.index;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"change_Box"}).then(function(){a.list.splice(i,1),n&&a.getDataDeleteEntityAjax(n),a.list.length-1==a.hotWordEntityActive?(a.$store.commit("changeHotWordEntityActive",-1),a.$root.toolkit.clear(),a.$store.commit("changeEntityDataObj",{}),a.$store.commit("changeEntityLeftList",[]),a.$store.commit("changeEntityListName",[])):setTimeout(function(){t(".elc_content .is_active").trigger("click")})}).catch(function(t){console.log(t)})},getForeignKeyAjax:function(){var t=this;Object(c.m)({userId:this.$root.userId}).then(function(e){"success"==e.message&&t.$store.commit("changeForeignKeyList",e.data)}).catch(function(t){console.log(t)})},getDataEntityAjax:function(){var e=this;Object(c.l)({userId:this.$root.userId}).then(function(a){console.log("获取实体列表接口",a,e.entityId),"success"==a.message&&(e.list=a.data,e.entityId&&setTimeout(function(){t(".elc_content li").each(function(a,n){t(n).data("id")==e.entityId&&t(n).trigger("click")})}))}).catch(function(t){console.log(t)})},getDataDeleteEntityAjax:function(t){Object(c.k)({userId:this.$root.userId,entityId:t}).then(function(t){Object(l.a)({message:"删除成功",type:"success"})}).catch(function(t){console.log(t)})}},created:function(){},mounted:function(){this.getForeignKeyAjax(),this.getDataEntityAjax(),this.$store.commit("changeHotWordEntityActive",-1)}}}).call(e,a("L7Pj"))},PzVd:function(t,e){},Q1ws:function(t,e){},T9rb:function(t,e){},aAds:function(t,e){},cS2E:function(t,e){},dhLY:function(t,e,a){"use strict";(function(t){var n=a("sNc7"),i=a("/gfp");e.a={components:{entityJsPlumb:n.a,entityMore:i.a},data:function(){return{}},computed:{entityDataObj:function(){return this.$store.state.entityDataObj}},watch:{entityDataObj:function(t,e){}},methods:{add_preservation:function(){this.$refs.entityMore.addEntity()},cancel_preservation:function(){t(".is_active").trigger("click")}},created:function(){},mounted:function(){}}}).call(e,a("L7Pj"))},fjmk:function(t,e,a){"use strict";(function(t){var n=a("4YfN"),i=a.n(n),o=a("9rMa"),l=(a("tm/j"),a("jt1B"));e.a={components:{},porps:{},data:function(){return{dataList:{},foreignKeys:[]}},computed:i()({},Object(o.c)(["themeColor","foreignKeyList","entityLeftList","entityDataObj","commonArr"])),watch:{foreignKeyList:{handler:function(t,e){var a=this;t&&setTimeout(function(){a.jsPlumbToolkitList()},0)},deep:!0},entityLeftList:{handler:function(e,a){var n=this;if(console.log("entityLeftList，监听中间部分数组的变化",e),this.foreignKeys=[],this.$root.toolkit.clear(),0!=e.length){for(var i={nodes:[],edges:[]},o=0;o<e.length;o++)i.nodes.push(t.extend(!0,{type:"table"},e[o]));this.$root.toolkit.load({data:i});for(o=0;o<e.length;o++)for(var l=e[o].foreignKey,r=0;r<l.length;r++){var s=l[r];if(-1==this.foreignKeys.indexOf(s.foreignKeyId))this.foreignKeys.push(s.foreignKeyId);else{var c={source:s.mainTableId+"."+s.mainColumnId,target:s.relTableId+"."+s.relColumnId,data:{foreignKeyId:s.foreignKeyId}};this.$root.toolkit.addEdge(c)}}setTimeout(function(){for(var e=n.entityDataObj.includeTable,a=[],i=0;i<e.length;i++)for(var o=e[i].attr,l=e[i].tableId,r=e[i].tableName,s=0;s<o.length;s++){var c=o[s].columnId;a.push({tableId:l,tableName:r,attrName:o[s].attrName,columnId:c,columnName:o[s].columnName,toggle:!0}),t(".table-columns input").each(function(e,a){t(a).data("id")==c&&t(a).attr("checked",!0)})}n.$store.commit("changeCommonArr",a)},0)}else this.$store.commit("changeCommonArr",[])},deep:!0}},methods:{jsPlumbToolkitList:function(){var e=this;t(".jtk-lasso").remove(),jsPlumbToolkit.ready(function(){var a=document.querySelector("#jtk-demo-dbase-entity"),n=a.querySelector(".jtk-demo-canvas"),i=a.querySelector(".miniview");e.$root.toolkit=jsPlumbToolkit.newInstance({idFunction:function(t){return t.id},typeFunction:function(t){return t.type},nodeFactory:function(a,n,i,o){if(!t(".elc_content li").hasClass("is_active"))return Object(l.a)({message:"请先选择实体！",type:"info"}),!1;var r=t.extend(!0,{},o.data);r.left=n.left,r.top=n.top,r.type=n.type,i(r);for(var s=[],c=e.$root.toolkit.getNodes(),m=0;m<c.length;m++)s.push(c[m].data);e.$store.commit("changeEntityRightList",s);for(var d=o.data.foreignKey,u=0;u<d.length;u++){var f=d[u];if(-1==e.foreignKeys.indexOf(f.foreignKeyId))e.foreignKeys.push(f.foreignKeyId);else{var h={source:f.mainTableId+"."+f.mainColumnId,target:f.relTableId+"."+f.relColumnId,data:{foreignKeyId:f.foreignKeyId}};e.$root.toolkit.addEdge(h)}}},edgeFactory:function(t,e,a){a(e)},portExtractor:function(t,e){return t.column||[]},portUpdater:function(t,e,a){return jsPlumb.extend(t,{column:jsPlumbToolkitUtil.map(a,function(t){return t.data})})},beforeConnect:function(t,e){return t!==e&&t.getNode()!==e.getNode()},portDataProperty:"column"});var o=window.renderer=e.$root.toolkit.render({container:n,enableWheelZoom:!0,view:{nodes:{table:{template:"tmplTable"}},edges:{default:{anchor:["Left","Right"],Anchors:["Right","Left"],connector:"Flowchart",paintStyle:{fill:e.themeColor,stroke:e.themeColor},hoverPaintStyle:{fill:e.themeColor,stroke:e.themeColor},ConnectionsDetachable:!1,deleteEndpointsOnDetach:!1,detachable:!1,edgeType:"common",maxConnections:-1,elementsDraggable:!1,events:{click:function(t){e.$root.toolkit.removeEdge(t.edge)}},overlays:[["Arrow",{location:1,visible:!0,width:11,length:11}]]}},ports:{default:{template:"tmplColumn",anchor:["Left","Right"],Anchors:["Right","Left"],paintStyle:{fill:"",stroke:""},hoverPaintStyle:{fill:"",stroke:""},edgeType:"common",maxConnections:-1,overlays:[["Arrow",{location:1,visible:!0,width:11,length:11}]],allowLoopback:!1,allowNodeLoopback:!1,interceptors:{beforeDrop:function(t){return!1},beforeDetach:function(t){console.log(t)}}}}},layout:{type:"Hierarchical",parameters:{padding:[20,100]}},miniview:{container:i},events:{edgeAdded:function(t){t.addedByMouse&&e.$root.toolkit.updateEdge(t.edge)},canvasClick:function(t){e.$root.toolkit.clearSelection()}},consumeRightClick:!1,zoomToFit:!1});o.registerDroppableNodes({droppables:t(".drag-li"),dragOptions:{zIndex:5e4,cursor:"move",clone:!0},typeExtractor:function(e,a,n,i){var o=t(e).attr("data");return a.data=JSON.parse(o),e.getAttribute("jtk-node-type")},dataGenerator:function(t,e,a,n){return{name:t}}}),jsPlumb.on(n,"click",".table-columns li input",function(){var a=o.getObjectInfo(this);if(t(this).is(":checked")){var n=a.obj.getNode().data.id,i=a.obj.getNode().data.tableName;e.commonArr.push({tableId:n,tableName:i,attrName:a.obj.data.columnName,columnId:a.id,columnName:a.obj.data.columnName,toggle:!0}),e.$store.commit("changeCommonArr",e.commonArr)}else for(var l=0;e.commonArr.length;l++)if(e.commonArr[l].columnId==a.id)return e.commonArr.splice(l,1),void e.$store.commit("changeCommonArr",e.commonArr)})})}},mounted:function(){}}}).call(e,a("L7Pj"))},gbX4:function(t,e){},sNc7:function(t,e,a){"use strict";var n=a("fjmk"),i={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"entity_jsplumb"},[e("div",{staticClass:"jtk-bootstrap jtk-bootstrap-wide jtk_entity_jsplumb"},[e("div",{staticClass:"jtk-page-container"},[e("div",{staticClass:"jtk-container"},[e("script",{attrs:{type:"jtk",id:"tmplTable"}},[this._v('\n\t\t\t\t\t<div class="table node">\n\t\t\t\t\t\t<div class="name">\n\t\t\t\t\t\t\t<span>${tableName}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ul class="table-columns">\n\t\t\t\t\t\t\t<r-each in="column">\n\t\t\t\t\t\t\t\t<r-tmpl id="tmplColumn" />\n\t\t\t\t\t\t\t</r-each>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t')]),this._v(" "),e("script",{attrs:{type:"jtk",id:"tmplColumn"}},[this._v('\n\t\t\t\t\t<li class="table-column table-column-type-${hasOut}" data-port-id="${id}">\n\t\t\t\t\t\t\x3c!--table-column-type-${datatype}   --\x3e\n\t\t\t\t\t\t<div class="entityJsplumb_input clearfix">\n\t\t\t\t\t\t\t<input type="checkbox" data-id="${id}" />\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div title="${columnName}" class="column_name">${columnName}</div>\n\t\t\t\t\t\t<jtk-source port-id="${id}" scope="${hasOut}" filter=".entityJsplumb_input, .entityJsplumb_input input,.entityJsplumb_input span" filter-exclude="true" />\n\t\t\t\t\t\t\x3c!--class="cover"--\x3e\n\t\t\t\t\t\t<jtk-target port-id="${id}" scope="${hasIn}" />\n\t\t\t\t\t</li>\n\t\t\t\t')]),this._v(" "),e("div",{staticClass:"jtk-demo-main",attrs:{id:"jtk-demo-dbase-entity"}},[e("div",{staticClass:"jtk-demo-canvas"},[e("div",{staticClass:"miniview"})])])])])])])}]};var o=function(t){a("aAds"),a("T9rb")},l=a("vSla")(n.a,i,!1,o,"data-v-4a0a9a2c",null);e.a=l.exports},tbaP:function(t,e,a){"use strict";(function(t){var n=a("4YfN"),i=a.n(n),o=a("9rMa"),l=a("gyMJ"),r=a("jt1B");e.a={components:{},data:function(){return{labelPosition:"left",formEntity:{majorKeyName:"",majorKeyField:"",literalName:"",literalField:""},rules:{majorKeyField:[{required:!0,message:"请输入内容",trigger:"blur"}],literalField:[{required:!0,message:"请输入内容",trigger:"blur"}]},opMajorKeyName:[],opMajorKeyField:[],opLiteralName:[],opLiteralField:[],tableData:[],active:-1,newDate:"",preventConflict:!0,entityName:"",majorId:"",literalId:"",attrObj:[]}},computed:i()({},Object(o.c)(["entityListName","entityRightList","entityDataObj","commonArr","entityId","entityUpdata"])),watch:{entityListName:{handler:function(t,e){this.$refs.formEntity.clearValidate(),this.opMajorKeyName=t,this.opLiteralName=t},deep:!0},entityRightList:{handler:function(t,e){this.opMajorKeyName=t,this.opLiteralName=t},deep:!0},entityDataObj:{handler:function(t,e){console.log("实体对象，用于控制连线",t),this.entityName=t.entityName,t.entityId?(this.formEntity.majorKeyName=t.entityPrimaryTableId,this.changeMajorKeyName(t.entityPrimaryTableId),this.formEntity.majorKeyField=t.entityPrimaryColumnId,this.formEntity.literalName=t.literalTableId,this.changeLiteralName(t.literalTableId),this.formEntity.literalField=t.literalColumnId,this.literalId=t.literalColumnId,this.majorId=t.entityPrimaryColumnId):(this.opMajorKeyName=[],this.opMajorKeyField=[],this.opLiteralName=[],this.opLiteralField=[],this.$refs.formEntity.resetFields())},deep:!0},commonArr:{handler:function(t,e){console.log("监听右侧实体属性数组的变化",t),this.tableData=t},deep:!0}},methods:{changeMajorKeyName:function(t){var e=this;this.opMajorKeyField=[],this.formEntity.majorKeyField="",this.opMajorKeyName.map(function(a,n){a.id==t&&(e.opMajorKeyField=a.column)})},changeLiteralName:function(t){var e=this;this.opLiteralField=[],this.formEntity.literalField="",this.opLiteralName.map(function(a,n){a.id==t&&(e.opLiteralField=a.column)})},changeMajorKeyField:function(t){this.majorId=t},changeLiteralField:function(t){this.literalId=t},show:function(t,e){var a=this;this.tableData[t].toggle=!1,this.newDate=e,this.active=t,setTimeout(function(){a.$refs.newDate.focus()})},changeFolder:function(t,e){var a=this;this.preventConflict&&("keyup"==t.type&&(this.preventConflict=!1,setTimeout(function(){a.preventConflict=!0})),""!=this.newDate&&this.newDate!=e&&(this.tableData[this.active].attrName=this.newDate),this.tableData[this.active].toggle=!0)},addEntity:function(){var e=this;""!=this.entityName?this.$refs.formEntity.validate(function(a){if(a){var n=!1,i=!1;if(0==e.commonArr.length)return void Object(r.a)({message:"请至少选则一个列，没有选择列的数据表不会保存！"});if(t.each(e.commonArr,function(t,a){if(a.tableId==e.formEntity.majorKeyName)return n=!0,!1}),t.each(e.commonArr,function(t,a){if(a.tableId==e.formEntity.literalName)return i=!0,!1}),0==n)return void Object(r.a)({message:"实体主键所在的表必须有选中的列！"});if(0==i)return void Object(r.a)({message:"字面量所在的表必须有选中的列！"});e.attrObj=[];for(var o=0;o<e.tableData.length;o++){var s=e.tableData[o];e.attrObj.push({columnId:s.columnId,attrName:s.attrName})}Object(l.a)({userId:e.$root.userId,entityId:e.entityId,entityName:e.entityName,attr:e.attrObj,literalColumnId:e.literalId,entityPrimaryColumnId:e.majorId}).then(function(t){console.log("保存实体",t,e.entityId),t.data.status&&(e.$store.commit("changeEntityUpdata",!e.entityUpdata),""==e.entityId&&e.$store.commit("changeEntityId",t.data.entity.entityId),Object(r.a)({message:"保存成功"}))}).catch(function(t){Object(r.a)({message:t})})}else Object(r.a)({message:"该实体未配置主键或字面量"})}):Object(r.a)({message:"请选择一个实体或者新建实体，然后拖入数据表！",type:"info"})}},created:function(){},mounted:function(){}}}).call(e,a("L7Pj"))},wFeW:function(t,e,a){"use strict";var n=a("4YfN"),i=a.n(n),o=a("9rMa"),l={components:{},data:function(){return{activeNames:["1"]}},props:{list:{type:Array},pageType:{type:String}},computed:i()({},Object(o.c)(["hotWordEntityActive"])),watch:{},methods:{clickEntity:function(t,e){var a={item:t,index:e};this.$emit("event-click-entity",a)},changeName:function(t,e){var a={entityName:t,index:e};this.$emit("event-click-change",a)},deleteName:function(t,e){var a={entityId:t,index:e};this.$emit("event-click-delete",a)}},mounted:function(){}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-collapse",{staticClass:"hot_word_entity",model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"实体列表",name:"1"}},[a("ul",{staticClass:"elc_content"},t._l(t.list,function(e,n){return a("li",{key:n,staticClass:"transition",class:{is_active:t.hotWordEntityActive==n},attrs:{"data-id":e.entityId},on:{click:function(a){t.clickEntity(e,n)}}},[a("i",{staticClass:"iconfont icon-shitimoshi"}),t._v(" "+t._s(e.entityName)+"\n\t\t\t\t"),"entity"==t.pageType?a("i",{staticClass:"iconfont icon-bi elc_left",on:{click:function(a){a.stopPropagation(),t.changeName(e.entityName,n)}}}):t._e(),t._v(" "),"entity"==t.pageType?a("i",{staticClass:"iconfont icon-unie639 elc_left",on:{click:function(a){a.stopPropagation(),t.deleteName(e.entityId,n)}}}):t._e()])}))])],1)},staticRenderFns:[]};var s=a("vSla")(l,r,!1,function(t){a("CceU")},null,null);e.a=s.exports},xS3o:function(t,e,a){"use strict";var n=a("4YfN"),i=a.n(n),o=a("9rMa"),l={components:{},props:{},data:function(){return{activeServer:[1],activeDatabase:[],activeTable:[]}},computed:i()({},Object(o.c)(["hotWordTableActive","foreignKeyList"])),watch:{},methods:{getHotWord:function(t,e){this.$store.commit("changeHotWordTableActive",e),this.$store.commit("changeHotWordEntityActive",-1),this.$store.commit("changeHotWord",t)}},created:function(){},mounted:function(){}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"foreignKeyLeftList"},[a("el-collapse",{staticClass:"collapse-server",attrs:{accordion:""},model:{value:t.activeServer,callback:function(e){t.activeServer=e},expression:"activeServer"}},t._l(t.foreignKeyList,function(e,n){return a("el-collapse-item",{key:n,attrs:{name:n+1}},[a("template",{slot:"title"},[a("p",{attrs:{title:e.host+"服务器"}},[t._v(t._s(e.host)+" 服务器")])]),t._v(" "),a("el-collapse",{staticClass:"collapse-database",attrs:{accordion:""},model:{value:t.activeDatabase,callback:function(e){t.activeDatabase=e},expression:"activeDatabase"}},t._l(e.database,function(e,n){return a("el-collapse-item",{key:n,attrs:{name:n+1}},[a("template",{slot:"title"},[a("p",{staticClass:"database-title",attrs:{title:e.databaseName}},[a("i",{staticClass:"iconfont icon-shuju"}),t._v(t._s(e.databaseName))])]),t._v(" "),a("el-collapse",{staticClass:"collapse-table",attrs:{accordion:""},model:{value:t.activeTable,callback:function(e){t.activeTable=e},expression:"activeTable"}},t._l(e.table,function(e,n){return a("el-collapse-item",{key:n,staticClass:"drag-li",attrs:{name:n+1,"jtk-node-type":"table",data:JSON.stringify(e)}},[a("template",{slot:"title"},[a("p",{staticClass:"table-title",attrs:{title:e.tableName}},[a("i",{staticClass:"iconfont icon-shujubiao"}),t._v(t._s(e.tableName))])]),t._v(" "),a("ul",{staticClass:"column-list"},t._l(e.column,function(e,n){return a("li",{key:n,staticClass:"column"},[a("span",[t._v(t._s(e.columnName))]),t._v(" "),a("i",{class:[e.hasIn?"hasIn":"",e.hasOut?"hasOut":""]})])}))],2)}))],2)}))],2)}))],1)},staticRenderFns:[]};var s=a("vSla")(l,r,!1,function(t){a("gbX4")},null,null);e.a=s.exports}});